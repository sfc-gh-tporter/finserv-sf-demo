create or replace database FINSERV_DEMO;

create or replace schema DIMS;

create or replace TABLE DIM_ASSET_CLASS (
	ASSET_CLASS_HASH VARCHAR(16777216),
	ASSET_CLASS_DESCRIPTION VARCHAR(16777216),
	NUMBER_OF_SECURITIES NUMBER(38,0),
	SECTOR VARCHAR(16777216),
	MARKETCAP VARCHAR(16777216),
	GEO VARCHAR(16777216),
	SECURITY_TYPE VARCHAR(16777216)
);
create or replace TABLE DIM_DATE (
	BUSINESS_DATE DATE NOT NULL,
	IS_BUSINESS_DAY BOOLEAN DEFAULT TRUE,
	DAY_OF_WEEK VARCHAR(10),
	IS_HOLIDAY BOOLEAN DEFAULT FALSE,
	HOLIDAY_NAME VARCHAR(100),
	primary key (BUSINESS_DATE)
);
create or replace TABLE DIM_PORTFOLIO_COMPOSITION (
	PORTFOLIO_ID NUMBER(38,0),
	PORTFOLIO_DESCRIPTION VARCHAR(16777216),
	RISK_LEVEL NUMBER(38,0),
	RISK_LEVEL_DESCRIPTION VARCHAR(16777216),
	ASSET_CLASS_COMPOSITION VARCHAR(16777216)
);
create or replace TABLE DIM_RETIREMENT_PLAN_FUNDS (
	TICKER VARCHAR(16777216),
	FUND_NAME VARCHAR(16777216),
	TARGET_YEAR NUMBER(38,0),
	YEARS_TO_RETIREMENT NUMBER(38,0),
	BOND_PCT NUMBER(38,2),
	US_HIGH_CAP_PCT NUMBER(38,2),
	INTERNATIONAL_PCT NUMBER(38,2),
	US_MID_CAP_PCT NUMBER(38,2),
	EMERGING_MARKETS_PCT NUMBER(38,2),
	TOTAL_EQUITY_PCT NUMBER(38,17),
	TOTAL_BOND_PCT NUMBER(38,2)
);
create or replace TABLE DIM_SECURITIES (
	TICKER VARCHAR(16777216),
	NAME VARCHAR(16777216),
	EXCHANGE VARCHAR(16777216),
	SECTOR VARCHAR(16777216),
	MARKETCAP VARCHAR(16777216),
	GEO VARCHAR(16777216),
	ASSET_CLASS_HASH VARCHAR(16777216)
);
alter schema DIMS set tag TAGS.PUBLIC.BUSINESS_UNIT='Central_IT';

create or replace schema GH_UTIL;

create or replace schema MAP;

create or replace TABLE CUSTOMER_ADVISOR (
	CUSTOMER_ID NUMBER(38,0),
	ADVISOR_ID NUMBER(38,0)
);
create or replace TABLE CUSTOMER_PORTFOLIO (
	CUSTOMER_ID NUMBER(38,0),
	PORTFOLIO_ID NUMBER(38,0),
	START_DATE DATE,
	END_DATE VARCHAR(16777216),
	ACTIVE BOOLEAN
);
create or replace TABLE CUSTOMER_RETIREMENT_PLANS (
	CUSTOMER_ID NUMBER(38,0),
	EMPLOYER_ID NUMBER(38,0),
	CUSTOMER_AGE NUMBER(38,0),
	RETIREMENT_YEAR NUMBER(38,0),
	IS_RETIRED BOOLEAN,
	ASSIGNED_FUND_TICKER VARCHAR(16777216),
	ASSIGNED_FUND_NAME VARCHAR(16777216),
	ASSIGNED_FUND_YEAR NUMBER(38,0),
	YEARS_TO_FUND_TARGET NUMBER(38,0),
	FUND_EQUITY_PCT NUMBER(38,16),
	FUND_BOND_PCT NUMBER(38,2)
);
create or replace schema PUBLIC;

create or replace schema RAW_DATA;

create or replace TABLE ADVISORS (
	ADVISOR_ID NUMBER(38,0),
	FIRST_NAME VARCHAR(16777216),
	LAST_NAME VARCHAR(16777216),
	AGE NUMBER(38,0),
	STREET_ADDRESS VARCHAR(16777216),
	STATE VARCHAR(16777216),
	ZIP_CODE NUMBER(38,0),
	COUNTRY VARCHAR(16777216),
	PHONE_NUMBER VARCHAR(16777216),
	ADVISOR_START_DATE DATE
);
create or replace TABLE CUSTOMERS (
	CUSTOMER_ID NUMBER(38,0),
	FIRST_NAME VARCHAR(16777216),
	LAST_NAME VARCHAR(16777216),
	BIRTHDATE DATE,
	AGE NUMBER(38,0),
	STREET_ADDRESS VARCHAR(16777216),
	STATE VARCHAR(16777216),
	ZIP_CODE NUMBER(38,0),
	COUNTRY VARCHAR(16777216),
	PHONE_NUMBER VARCHAR(16777216),
	SSN VARCHAR(16777216),
	EMPLOYEE_ID VARCHAR(16777216),
	EMPLOYER_ID NUMBER(38,0),
	HIRE_DATE DATE,
	START_DATE DATE,
	RETIREMENT_AGE NUMBER(38,0),
	RETIREMENT_DATE DATE,
	RETIRED BOOLEAN,
	REPORTED_RISK_LEVEL NUMBER(38,0),
	RISK_LEVEL_DESCRIPTION VARCHAR(16777216),
	SALARY NUMBER(38,2),
	JOB_TITLE VARCHAR(16777216),
	DEPARTMENT VARCHAR(16777216),
	CUSTOMER_TYPE VARCHAR(16777216)
);
create or replace TABLE EMPLOYERS (
	EMPLOYER_ID NUMBER(38,0),
	COMPANY_NAME VARCHAR(16777216),
	INDUSTRY VARCHAR(16777216),
	EMPLOYEE_COUNT NUMBER(38,0),
	SIZE_CATEGORY VARCHAR(16777216)
);
create or replace TABLE RETIREMENT_CONTRIBUTIONS (
	TRANSACTION_DATE TIMESTAMP_NTZ(9),
	SHARE_AMOUNT NUMBER(38,2),
	TRADE_PRICE NUMBER(38,2),
	ACCOUNT_TYPE_NAME VARCHAR(16777216),
	TOTAL_TRADE_AMOUNT NUMBER(38,2),
	TICKER VARCHAR(16777216),
	TRANSACTION_CATEGORY VARCHAR(16777216),
	CUSTOMER_ID NUMBER(38,0),
	CONTRIBUTION_SCHEDULE VARCHAR(16777216)
);
create or replace TABLE SECURITY_TRADES (
	CUSTOMER_ID NUMBER(38,0),
	ACCOUNT_TYPE VARCHAR(16777216),
	TRANSACTION_DATE DATE,
	TICKER VARCHAR(16777216),
	SHARES NUMBER(38,6),
	PRICE NUMBER(38,2),
	TOTAL_AMOUNT NUMBER(38,2),
	TRANSACTION_CATEGORY VARCHAR(16777216),
	TRANSACTION_ACTION VARCHAR(16777216)
);
CREATE OR REPLACE FILE FORMAT PARQUET_FORMAT
	TYPE = PARQUET
	NULL_IF = ()
;
alter schema RAW_DATA set tag TAGS.PUBLIC.BUSINESS_UNIT='Central_IT';
